# Predictor Algorithm in `6.predictions]a0.c` 📈🧠✨

Welcome to the wild world of stock price prediction in our trading game! 🎮💸 This `predictor.md` dives into the current algorithm used in `6.predictions]a0.c` to make buy/sell/hold decisions based on the AR(2)/AR(3)-generated stock data from `program.c`. We’ll explain how it works, why it’s cool, and how we can level it up with fancier methods like LSTM! 🚀🌟 Let’s get started!

## 🎯 Current Algorithm: Moving Average Crossover 📊

The prediction algorithm in `6.predictions]a0.c` uses a **5-week vs. 10-week moving average crossover strategy** to decide when to **buy**, **sell**, or **hold** for each stock. It’s simple, intuitive, and works well with the AR(2)/AR(3) data generated in `program.c`. Here’s the breakdown with emojis to keep it fun! 😎🔥

### 🛠️ How It Works

1. **Data Input** 📂:
   - The program reads stock prices from `GEN/<TICKER>_GEN.txt` (50 weeks of prices) and seed data from `GEN/<TICKER>_seed.txt` 📑.
   - These prices are generated by `program.c` using AR(2) or AR(3) models, which create realistic swings (e.g., growing, dying, cyclical) based on past prices and random noise 🎢.

2. **Moving Averages** 📈:
   - **Short-term MA**: 5-week simple moving average (average of the last 5 weeks’ prices) 🕒.
   - **Long-term MA**: 10-week simple moving average (average of the last 10 weeks’ prices) ⏰.
   - Calculated as: \( \text{MA}_n = \frac{1}{n} \sum_{i=t-n+1}^{t} \text{price}_i \), where \( n = 5 \) or \( 10 \), and \( t \) is the current week.

3. **Decision Rules** 🎲:
   - **Buy** 🟢: If the 5-week MA crosses **above** the 10-week MA (i.e., `prev_short_ma <= prev_long_ma && short_ma > long_ma`), buy all possible shares with available cash ($1000 per round) 💰.
   - **Sell** 🔴: If the 5-week MA crosses **below** the 10-week MA, sell all shares 🏦.
   - **Hold** ⚪: If no crossover occurs or already holding shares, do nothing 😴.
   - Predictions are made per week, grouped into 4 rounds (weeks 1-13, 14-26, 27-39, 40-50) 🗓️.

4. **Rounds Structure** 📅:
   - Each stock’s 50 weeks are split into 4 rounds (13, 13, 13, 11 weeks) to mimic the game’s progression in `5.bloom.berg.gen🪞️📈️📉️]f9.c` 🎮.
   - Cash resets to $1000 at the start of each round, and percent gain/loss is calculated as: \( \frac{\text{final_portfolio} - 1000}{1000} \times 100 \) 📊.

5. **Outputs** 📝:
   - **prediction/rounds.txt**: Logs `ticker,round,week,trend_prediction,round_percent_gain_loss` for each of the 50 weeks per stock 📜.
     - Example: `SDLJ,1,5,Up,2.34` means a buy signal for SDLJ in round 1, week 5, with a 2.34% gain/loss for that round.
   - **prediction_<ticker>.png**: Shows the 50-week price chart (white line), buy/sell signals (green for profit, red for loss), round percent gain/loss, and overall gain/loss 📸.

6. **Why MA Crossover?** 🤔:
   - The AR(2)/AR(3) data has autoregressive patterns (prices depend on 2-3 prior prices), which can create trends or reversals 📉📈.
   - MA crossover captures momentum (short MA > long MA = upward trend) and reversals (short MA < long MA = downward trend), aligning with the data’s cyclical or mean-reverting behaviors 🌊.
   - It’s simple, computationally light, and works well for the game’s short-term trading focus 🎯.

### 🥳 Why It’s Cool
- **Simplicity**: Easy to understand and implement, perfect for quick predictions 🕒.
- **Trend-Following**: Catches the momentum in AR(2)/AR(3) data, like when a stock is “Growing” or “Cyclical” 🚀.
- **Visual Feedback**: Green/red lines in PNGs make it clear where trades made or lost money 💸.
- **Round-Based**: Matches the game’s structure, making it comparable to player performance in `5.bloom.berg.gen` 🎮.

## 🚀 Making It Better: Improvements & Alternatives

The MA crossover is solid, but it’s basic and can miss complex patterns in the AR(2)/AR(3) data. Here are ways to level up the predictor, from tweaks to wild AI methods like LSTM! 🌟🧠

### 1. **Tweak the Current Algorithm** 🛠️
- **Adjust MA Windows** 🔧:
  - Try 3-week vs. 8-week MAs for faster reactions or 7-week vs. 15-week for smoother trends 📉.
  - Use **exponential moving averages (EMA)** to give more weight to recent prices: \( \text{EMA}_t = \alpha \cdot \text{price}_t + (1 - \alpha) \cdot \text{EMA}_{t-1} \), where \( \alpha = \frac{2}{n+1} \).
  - Why? EMA reacts quicker to the AR(2)/AR(3) swings, especially for “Volatile Sideways” stocks ⚡.
- **Add Confirmation Signals** ✅:
  - Require a minimum MA difference (e.g., `short_ma - long_ma > threshold`) to avoid false crossovers 🤥.
  - Check volume or volatility (from seed data) to confirm trends 📊.
  - Why? Reduces noise-driven trades in “Mean-Reverting” stocks 🔄.
- **Dynamic Round Lengths** 📅:
  - Adjust round boundaries based on volatility or trend length (e.g., shorter rounds for “Volatile Sideways” stocks) 🌪️.
  - Why? Aligns trading with the stock’s natural cycle length from AR(3) parameters 🎢.

### 2. **Add Technical Indicators** 📈
- **Relative Strength Index (RSI)** 📉:
  - Calculate RSI: \( \text{RSI} = 100 - \frac{100}{1 + \frac{\text{Avg Gain}}{\text{Avg Loss}}} \) over 14 weeks.
  - Buy if RSI < 30 (oversold), sell if RSI > 70 (overbought) 🚦.
  - Why? Complements MA crossover by catching overreactions in “Mean-Reverting” stocks 🔄.
- **MACD (Moving Average Convergence Divergence)** 📊:
  - Use 12-week EMA - 26-week EMA, with a 9-week signal line.
  - Buy when MACD crosses above signal, sell when below 📈📉.
  - Why? Captures longer-term trends in “Growing” or “Dying” stocks from AR(2)/AR(3) data 🌱💀.
- **Bollinger Bands** 📏:
  - Plot 20-week MA ± 2 standard deviations.
  - Buy when price touches lower band, sell at upper band 🎯.
  - Why? Works well for “Cyclical” stocks with predictable oscillations 🌊.

### 3. **Incorporate Seed Data** 📑
- **Use AR Coefficients** 🧮:
  - Parse `phi1`, `phi2`, `phi3` from `<TICKER>_seed.txt` to predict trend strength.
  - Example: If `phi2 < 0`, expect mean-reversion; adjust MA windows to be shorter 📉.
  - Why? Leverages the AR(2)/AR(3) structure directly for tailored predictions 🎯.
- **Trend Type Hints** 🌟:
  - Use the `Trend type` (e.g., “Growing”, “Cyclical”) from seed data to adjust strategy (e.g., longer holds for “Growing” stocks) 📈.
  - Why? Aligns predictions with the stock’s intended behavior 🏦.

### 4. **Advanced Machine Learning: LSTM** 🧠💻
- **What’s LSTM?** 😍:
  - Long Short-Term Memory (LSTM) is a type of recurrent neural network (RNN) that excels at time-series prediction 📈.
  - It learns patterns from sequences (like our 50-week prices) by remembering long-term dependencies, perfect for AR(2)/AR(3) data 🕰️.
- **How to Implement** 🚀:
  - **Preprocess**: Normalize prices (e.g., to [0,1]) and create sequences (e.g., last 10 weeks to predict the next) 📊.
  - **Model**: Use a Python library like TensorFlow/Keras to build an LSTM:
    ```python
    from tensorflow.keras.models import Sequential
    from tensorflow.keras.layers import LSTM, Dense
    model = Sequential([
        LSTM(50, input_shape=(10, 1), return_sequences=False),
        Dense(1)
    ])
    model.compile(optimizer='adam', loss='mse')
    ```
  - **Train**: Use historical prices from `GEN/` to train, predicting the next week’s price or trend direction 📉.
  - **Predict**: Output “Up”/“Down”/“Hold” based on predicted price changes 🎯.
- **Why LSTM?** 🌟:
  - Captures complex patterns (e.g., cycles in “Cyclical” stocks) that MA crossover might miss 🔄.
  - Adapts to the AR(2)/AR(3) dependencies without needing explicit coefficients 🧮.
  - Can incorporate seed data (e.g., volatility) as additional features 📑.
- **Challenges** ⚠️:
  - Requires more data (multiple stocks or synthetic data augmentation) 📂.
  - Computationally heavy; needs Python, not C, and GPU support 💻.
  - Risk of overfitting to the AR(2)/AR(3) noise 🤥.

### 5. **Other ML Alternatives** 🤖
- **Random Forest** 🌳:
  - Train a Random Forest classifier on features like past prices, MAs, RSI, and seed data (volatility, trend type) to predict “Buy”/“Sell”/“Hold” 🏷️.
  - Why? Robust to noise, handles non-linear patterns, and works in C with libraries like `libml` 🌟.
- **ARIMA** 📉:
  - Fit an ARIMA(p,d,q) model to the price series, using the AR(2)/AR(3) structure from seed data to set \( p = 2 \) or \( 3 \).
  - Predict next week’s price and base decisions on the forecast 📈.
  - Why? Directly leverages the AR(2)/AR(3) model, potentially outperforming MA crossover for stationary series 🔄.
- **Reinforcement Learning (RL)** 🎮:
  - Use an RL agent (e.g., Q-learning or DQN) to learn optimal buy/sell actions by maximizing portfolio value 💸.
  - Why? Adapts to the game’s reward structure (profit/loss) and can learn complex strategies 🧠.
  - Challenge: Requires significant coding effort and training time ⏰.

### 6. **Ensemble Methods** 🤝
- **Combine Predictors** 🌈:
  - Use a voting system: Combine MA crossover, RSI, and LSTM predictions (e.g., majority vote for “Buy”) 🗳️.
  - Why? Balances simplicity and complexity, reducing errors from any single method 🎯.
- **Weighted Signals** ⚖️:
  - Assign weights to predictors based on past performance (e.g., MA crossover = 0.4, LSTM = 0.6) 📊.
  - Why? Leverages strengths of each method for AR(2)/AR(3) data 📈.

## 🎉 Why These Improvements Matter
The current MA crossover is great for catching trends in the AR(2)/AR(3) data, but it’s blind to deeper patterns like cycles or reversals that LSTM or ARIMA could spot 🧠. Adding technical indicators or seed data makes predictions more tailored to each stock’s behavior (e.g., “Cyclical” vs. “Mean-Reverting”) 🌟. Advanced ML methods like LSTM could unlock next-level accuracy, but they need more data and computing power 💻. For our game, a mix of tweaked MAs and simple indicators (RSI, MACD) might be the sweet spot for balance and fun! 😎

## 🛠️ How to Implement Improvements
- **For MA Tweaks/Indicators**: Modify `compute_moving_average` to support EMA or add RSI/MACD functions in `6.predictions]a0.c`. Parse seed data in `load_stock_data` for coefficients 📑.
- **For LSTM**: Rewrite the predictor in Python using TensorFlow, train on `GEN/` data, and output predictions to a file that a C program can read for charting 📊.
- **For ARIMA**: Use a C library like `statsmodels` (or port to Python) to fit ARIMA models based on seed data’s AR order 🧮.
- **For Ensemble**: Combine predictions in `simulate_trading` with a voting or weighting logic 🤝.

## 🌟 Final Thoughts
The MA crossover in `6.predictions]a0.c` is a solid start, turning AR(2)/AR(3) data into actionable trades with clear visuals 🎨. By tweaking windows, adding indicators, or going wild with LSTM, we can make predictions sharper and more exciting! 🚀 Try the simple tweaks first (EMA, RSI) for quick wins, and dive into LSTM if you’re ready for a coding adventure! 😍 Got questions or want to code one of these? Let me know! 💬✨